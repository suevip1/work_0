<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dtstack.engine.dao.AlertAlarmRuleDao">

    <sql id="Base_Column_List">
        `id`, `alert_alarm_id`, `business_type`, `business_id`, `gmt_create`, `gmt_modified`,
        `is_deleted`
    </sql>

    <delete id="deleteByPrimaryKey">
        delete from alert_alarm_rule
        where `id` = #{id}
    </delete>

    <delete id="deleteByAlertId">
        delete from alert_alarm_rule
        where `alert_alarm_id`  = #{alarmId}
    </delete>

    <delete id="deleteByAlertIds">
        delete from alert_alarm_rule
        where `alert_alarm_id`  IN
        <foreach collection="alarmIds" item="alarmId" close=")" open="(" separator=",">
            #{alarmId}
        </foreach>
        <if test="businessType !=null">
            AND `business_type` = #{businessType}
        </if>
        <if test="businessIds != null">
            AND `business_id` IN
            <foreach collection="businessIds" item="businessId" close=")" open="(" separator=",">
                #{businessId}
            </foreach>
        </if>
    </delete>

    <delete id="deleteByCondition">
        delete from alert_alarm_rule
        where `alert_alarm_id`  IN
        <foreach collection="alarmIds" item="alarmId" close=")" open="(" separator=",">
            #{alarmId}
        </foreach>

        <if test="businessTypes != null">
            AND `business_type` IN
            <foreach collection="businessTypes" item="businessType" close=")" open="(" separator=",">
                #{businessType}
            </foreach>
        </if>

        <if test="businessIds != null">
            AND `business_id` IN
            <foreach collection="businessIds" item="businessId" close=")" open="(" separator=",">
                #{businessId}
            </foreach>
        </if>
    </delete>
    <delete id="deleteByIds">
        delete from alert_alarm_rule
        where `id` IN
        <foreach collection="ids" item="id" close=")" open="(" separator=",">
            #{id}
        </foreach>
    </delete>

    <insert id="batchInsert">
        insert into alert_alarm_rule (`alert_alarm_id`, `business_type`, `business_id`,`is_deleted`)
        values
        <foreach collection="alertAlarmRules" item="alertAlarmRule" separator=",">
            (#{alertAlarmRule.alertAlarmId}, #{alertAlarmRule.businessType}, #{alertAlarmRule.businessId}, #{alertAlarmRule.isDeleted})
        </foreach>
    </insert>

    <select id="selectByPrimaryKey" resultType="com.dtstack.engine.po.AlertAlarmRule">
        select
        <include refid="Base_Column_List" />
        from alert_alarm_rule
        where `id` = #{id}
    </select>

    <select id="selectAlarmByBusinessTypeAndBusinessId" resultType="java.lang.Long">
        select
        DISTINCT `alert_alarm_id`
        from alert_alarm_rule
        where `is_deleted` = 0 and
        `business_type` = #{businessType} and
        `business_id` IN
        <foreach collection="businessIds" open="(" close=")" item="businessId" separator=",">
            #{businessId}
        </foreach>
    </select>

    <select id="selectByAlarmIds" resultType="com.dtstack.engine.po.AlertAlarmRule">
        select
        <include refid="Base_Column_List" />
        from alert_alarm_rule
        where `is_deleted` = 0 and
        `alert_alarm_id` IN
        <foreach collection="alertAlarmIds" open="(" close=")" item="alertAlarmId" separator=",">
            #{alertAlarmId}
        </foreach>
        <if test="businessType!=null">
            AND `business_type` = #{businessType}
        </if>
    </select>

    <update id="updateByPrimaryKeySelective" parameterType="com.dtstack.engine.po.AlertAlarmRule">
        update alert_alarm_rule
        <set>
            <if test="alertAlarmId != null">
                `alert_alarm_id` = #{alertAlarmId},
            </if>
            <if test="businessType != null">
                `business_type` = #{businessType},
            </if>
            <if test="businessId != null">
                `business_id` = #{businessId},
            </if>
            <if test="gmtCreate != null">
                `gmt_create` = #{gmtCreate},
            </if>
            <if test="gmtModified != null">
                `gmt_modified` = #{gmtModified},
            </if>
            <if test="isDeleted != null">
                `is_deleted` = #{isDeleted},
            </if>
        </set>
        where `id` = #{id}
    </update>

    <update id="updateByPrimaryKey" parameterType="com.dtstack.engine.po.AlertAlarmRule">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri May 06 03:12:48 UTC 2022.
        -->
        update alert_alarm_rule
        set `alert_alarm_id` = #{alertAlarmId},
        `business_type` = #{businessType},
        `business_id` = #{businessId},
        `gmt_create` = #{gmtCreate},
        `gmt_modified` = #{gmtModified},
        `is_deleted` = #{isDeleted}
        where `id` = #{id}
    </update>
</mapper>